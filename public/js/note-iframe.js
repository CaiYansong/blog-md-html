var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.checkStringArgs=function(a,b,c){if(null==a)throw new TypeError("The 'this' value for String.prototype."+c+" must not be null or undefined");if(b instanceof RegExp)throw new TypeError("First argument to String.prototype."+c+" must not be a regular expression");return a+""};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,b,c,e){if(b){c=$jscomp.global;a=a.split(".");for(e=0;e<a.length-1;e++){var d=a[e];d in c||(c[d]={});c=c[d]}a=a[a.length-1];e=c[a];b=b(e);b!=e&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};
$jscomp.polyfill("String.prototype.startsWith",function(a){return a?a:function(a,c){var b=$jscomp.checkStringArgs(this,a,"startsWith");a+="";var d=b.length,f=a.length;c=Math.max(0,Math.min(c|0,b.length));for(var g=0;g<f&&c<d;)if(b[c++]!=a[g++])return!1;return g>=f}},"es6","es3");$jscomp.owns=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)};
$jscomp.assign="function"==typeof Object.assign?Object.assign:function(a,b){for(var c=1;c<arguments.length;c++){var e=arguments[c];if(e)for(var d in e)$jscomp.owns(e,d)&&(a[d]=e[d])}return a};$jscomp.polyfill("Object.assign",function(a){return a||$jscomp.assign},"es6","es3");var noteContainer=document.getElementById("note-container");function logInfo(a){noteContainer.innerText=noteContainer.innerText+"\nLog: "+a}logInfo("note-iframe init");var targetUrl="https://caiyansong.gitee.io";
window.addEventListener("message",function(a){logInfo("message",a.data.type+"---"+a.data.str);a.origin===targetUrl&&(a.data&&"post"===a.data.type?checkAPostYuqueStr(a.data.str,a.data.title||""+Date.now()):a.data&&"get"===a.data.type?getYuque(a.data.slug,function(a){postMessageToMain(a)}):a.data&&"getList"===a.data.type&&getYuqueList(function(a){postMessageToMain(a)}))});function postMessageToMain(a){a&&window.parent&&window.parent.postMessage&&window.parent.postMessage(a,targetUrl)}
function YuqueRequest(a){var b=a.token;this.userAgent=a.userAgent||"LP";this.token=b;this.headers={"Content-Type":"application/json","User-Agent":this.userAgent,"X-Auth-Token":this.token}}YuqueRequest.prototype.getApi=function(a){a&&!a.startsWith("/")&&(a="/"+a);return"https://caiyansong.com/api/v2/repos/yansong-s4rmt/lp/docs"+(a||"")};
YuqueRequest.prototype.request=function(a,b,c,e){var d=new XMLHttpRequest;d.open(b||"post",this.getApi(a));d.setRequestHeader("Content-Type",this.headers["Content-Type"]);d.setRequestHeader("User-Agent",this.headers["User-Agent"]);d.setRequestHeader("X-Auth-Token",this.headers["X-Auth-Token"]);d.send(JSON.stringify(c));d.onreadystatechange=function(){4===d.readyState&&e&&e(JSON.parse(d.response))}};YuqueRequest.prototype.get=function(a,b){this.request(a||"/note?row=1","GET",null,function(a){b&&b(a)})};
YuqueRequest.prototype.getList=function(a){this.request(null,"GET",null,function(b){a&&a(b)})};YuqueRequest.prototype.post=function(a,b){this.request(null,"POST",Object.assign({title:"Note",slug:"note",public:0,format:"markdown",body:""},a),function(a){b&&b(a)})};YuqueRequest.prototype.put=function(a,b){this.request("/"+b,"PUT",Object.assign({title:"Note",slug:"note",public:0,body:"",_force_asl:1},a),function(a){cb&&cb(a)})};
var token="jUrEGFwQzxypup0uDJRK2LyJOQcMeLVktQpCHpWm",defaultId=63815700,request=new YuqueRequest({token:token});function getYuque(a,b){b?request.get(b,function(b){a&&a(b)}):request.getList(function(b){b&&0<b.length?request.get(b[0].slug,function(b){a&&a(b)}):a&&a("")})}function getYuqueList(a){request.getList(function(b){a&&a(b)})}
function putYuqueStr(a,b,c,e){request.get(e,function(d){d&&request.put({body:d.data.body+"\n\n"+a,title:b,slug:e||b.toLowerCase().replace(/ /g,"")},c||defaultId,function(a){console.log("put end: ",a)})})}function postYuqueStr(a,b){request.post({body:a,title:b,slug:b.toLowerCase().replace(/ /g,"")},function(a){console.log("post end: ",a)})}
function checkAPostYuqueStr(a,b){getYuqueList(function(c){console.log("getList end: ",c);if(c&&c.data&&0<c.data.length){var e=null;c=c.data;for(var d=0;d<c.length;d++){var f=c[d];f&&f.slug===b.toLowerCase().replace(/ /g,"")&&(e=c[d])}e?putYuqueStr(a,b,e.id,e.slug):postYuqueStr(a,b)}})};